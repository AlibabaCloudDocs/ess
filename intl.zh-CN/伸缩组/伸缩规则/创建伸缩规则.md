# 创建伸缩规则

伸缩规则的作用由伸缩规则类型决定，可用于触发伸缩活动或者智能设置伸缩组边界值。本文介绍如何创建伸缩规则。

弹性伸缩支持四类伸缩规则，各类规则的功能对比和使用限制请参见[伸缩规则概述](/intl.zh-CN/伸缩组/伸缩规则/伸缩规则概述.md)。

一个伸缩组内可以创建的伸缩规则数量有限，详细信息请参见[使用限制](/intl.zh-CN/产品简介/使用限制.md)。

## 操作步骤

1.  登录[弹性伸缩控制台](https://essnew.console.aliyun.com/)。

2.  找到待操作的伸缩组，选择一种方式打开伸缩组详情页面。

    -   在**伸缩组名称/ID**区域，单击伸缩组ID。
    -   在**操作**区域，单击**查看详情**。
3.  在页面上方，单击**伸缩规则**页签。

4.  单击**创建伸缩规则**。

5.  完成伸缩规则的相关参数配置。

    1.  输入规则名称。

    2.  选择伸缩规则类型并完成对应的参数配置。

        **说明：** 成功创建伸缩规则后，不支持修改规则类型。

        各类型规则配置的参数说明请参见[步进规则参数说明](#table_k3g_2e4_d5k)、[预测规则参数说明](#table_sa7_0zz_g31)、[目标追踪规则参数说明](#table_ket_pwt_d92)或[简单规则参数说明](#table_58k_037_d3u)。

        -   步进规则的参数说明如下表所示。

            |名称|说明|
            |--|--|
            |**监控类型**|根据您需要关联的报警任务选择监控类型。             -   **系统监控**：选择该项后，您可以继续指定系统监控报警任务。
            -   **自定义监控**：选择该项后，您可以继续指定自定义监控报警任务。 |
            |**执行的时间**|指定一个报警任务，该报警任务的触发条件会作为分步步骤的参照条件。 例如，CPU使用率平均值连续3次 \>= 80%。

如果没有可用的报警任务，您也可以新建一个报警任务，详细参数说明请参见[创建报警任务](/intl.zh-CN/自动伸缩/报警任务/创建报警任务.md)。

**说明：** 如果您在创建步进规则时创建报警任务，该报警任务的监控资源自动设置为当前伸缩组，报警触发规则自动设置为当前步进规则。 |
            |**执行的操作**|基于报警任务触发条件继续设置分步步骤，指定违例规模及相应操作，在报警任务触发后，弹性伸缩会根据违例规模执行相应操作。您至少需要设置一个分步步骤。 示例如下：

            -   当80 <= CPU使用率平均值 < 90时，增加2台。
            -   当90 <= CPU使用率平均值 < +∞时，增加3台。
每个分步步骤中设置的违例规模受云监控指标的限制。例如，云监控指标为CPU使用率平均值连续3次 \>= 80%时，分步步骤必须从\>= 80 %开始设置。

步进规则支持的操作和简单规则相同：调整至N台、增加N台、减少N台、增加N%和减少N%。 |
            |**实例预热时间**|单位为秒。 处于预热状态的实例正常加入伸缩组，但是不会向云监控上报监控数据。动态计算需要扩缩容的实例数量时，处于预热状态的实例不计入现有实例数量，以免造成指标值波动。 例如，步进规则的实例预热时间为300秒，增加了2台实例，则在实例创建完成后300秒内，计算伸缩组内CPU使用率平均值时不会计入这2台实例的指标值。 |

        -   预测规则的参数说明如下表所示。

            **说明：** 一个伸缩组内只能创建一条预测规则。

            |名称|说明|
            |--|--|
            |**配合已有目标追踪规则**|是否配合已有的目标追踪规则。如果之前已有目标追踪规则，您可以选择沿用目标追踪规则的**指标类型**和**目标值**。|
            |**选择规则**|选中**配合已有目标追踪规则**后出现，您可以继续选择一条目标追踪规则，自动沿用该目标追踪规则的**指标类型**和**目标值**。|
            |**指标类型**|根据需要选择一项云监控指标：             -   **（ECS）平均CPU使用率**，单位为%。
            -   **（ECS）内网入流量的平均值**，单位为KB/Min。
            -   **（ECS）内网出流量的平均值**，单位为KB/Min。 |
            |**目标值**|所选云监控指标的目标值，预测规则将综合目标值等因素计算出合适的实例数量。 如果您修改了目标值，伸缩组会清空现存的预测任务，并在一小时内创建新的预测任务。 |
            |**预测模式**|视需要选择预测模式：             -   **只预测不伸缩**：产生预测结果，但不会创建预测任务。
            -   **预测并伸缩**：产生预测结果并创建预测任务。
建议您先选择**只预测不伸缩**，如果预测效果符合预期，再修改为**预测并伸缩**。您可以在伸缩规则详情中查看预测规则效果，具体操作请参见[查看预测规则效果](/intl.zh-CN/伸缩组/伸缩规则/查看预测规则效果.md)。 |
            |**预设最大值**|伸缩组实例数上限，和**最大值处理方式**结合使用。 默认值为当前的伸缩组内最大实例数。 |
            |**最大值处理方式**|当预测值大于预设最大值时，预测值的处理方式分为以下几种：             -   **预测值会覆盖预设最大值**：预测值大于预设最大值时， 预测任务的实例数最大值采用预测值。
            -   **预设最大值会覆盖预测值**：预测值大于预设最大值时，预测任务的实例数最大值采用预设最大值。
            -   **预测值会附加一定比例**：和**增加比例**结合使用。
默认值为**预测值会覆盖预设最大值**。 |
            |**增加比例**|**最大值处理方式**为**预测值会附加一定比例**时出现，当前预测值会按照该比例增加，并作为新的预测值。例如，当前预测值为100，增加比例为10%，则预测任务的实例数最大值采用110。 增加比例的默认值为0%，最大值为100%。 |
            |**预启动时间**|预测规则自动创建的预测任务默认均在整点执行，您可以设置预启动时间提前执行预测任务，预先准备资源。 预启动时间的单位为分钟，默认值为0分钟，最大值为60分钟。 |

        -   目标追踪规则的参数说明如下表所示。

            |名称|说明|
            |--|--|
            |**配合已有预测规则**|是否配合已有的预测伸缩规则。如果伸缩组内存在预测规则，您可以选择继承预测规则的指标类型和目标值。|
            |**指标类型**|根据需要选择一项云监控指标：             -   **（ECS）平均CPU使用率**
            -   **（ECS）内网入流量的平均值**
            -   **（ECS）内网出流量的平均值**
            -   **（ECS）公网入流量的平均值**
            -   **（ECS）公网出流量的平均值** |
            |**目标值**|云监控指标的目标值，目标追踪规则会将云监控指标值维持在目标值附近。|
            |**实例预热时间**|单位为秒。处于预热状态的实例正常加入伸缩组，但是不会向云监控上报监控数据。动态计算需要扩缩容的实例数量时，处于预热状态的实例不计入现有实例数量，以免造成指标值波动。|
            |**禁用缩容**|是否禁用缩容影响自动创建的报警任务的数量：             -   如果禁用缩容，目标伸缩规则只创建一个用于扩容的报警任务，因此不会从伸缩组移出ECS实例。
            -   如果允许缩容，目标伸缩规则会创建两个报警任务，一个用于扩容，一个用于缩容。 |

        -   简单规则的参数说明如下表所示。

            |名称|说明|
            |--|--|
            |**执行的操作**|根据需要选择一种操作：             -   调整至N台：执行伸缩规则后，伸缩组内实例的数量变为N台。最多能触发伸缩500台实例。
            -   增加N台：执行伸缩规则后，伸缩组内实例的数量在当前基础上增加N台。增加的数量不可超过500。
            -   增加N%：执行伸缩规则后，伸缩组内实例的数量在当前基础上增加N%。最多能触发伸缩500台实例。
            -   减少N台：执行伸缩规则后，伸缩组内实例的数量在当前基础上减少N台。减少的数量不可超过500。
            -   减少N%：执行伸缩规则后，伸缩组内实例的数量在当前基础上减少N%。最多能触发伸缩500台实例。 |
            |**冷却时间**|可选项，单位为秒。不填写则默认使用伸缩组的冷却时间，更多信息请参见[冷却时间](/intl.zh-CN/伸缩组/伸缩组/冷却时间.md)。|

6.  单击**确认**完成规则创建。


**相关文档**  


[CreateScalingRule](/intl.zh-CN/API参考/伸缩规则/CreateScalingRule.md)

