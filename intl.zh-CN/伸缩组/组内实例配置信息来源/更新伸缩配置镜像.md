# 更新伸缩配置镜像

更新伸缩配置镜像功能适用于频繁发布应用的场景。您只需在弹性伸缩控制台创建更新任务，执行任务时系统会自动为源ECS实例创建自定义镜像，并批量修改伸缩配置中的镜像，操作更加便捷。

更新镜像任务通过OOS服务执行，需要授予OOS服务操作相关资源的权限，请确保至少满足以下条件之一：

-   当前账号有操作ECS、弹性伸缩相关资源的权限。
-   已为OOS服务创建对应的RAM角色，并授予RAM角色操作ECS、弹性伸缩相关资源的权限。具体操作，请参见[为OOS服务设置RAM权限](https://www.alibabacloud.com/help/doc-detail/120810.htm)。

**说明：** 建议使用AliyunECSFullAccess和AliyunESSFullAccess权限。

使用更新伸缩配置镜像功能时，系统自动为源ECS实例创建一个自定义镜像，会收取相应快照容量的费用，遵循ECS快照的收费标准，详细说明请参见[快照计费](/intl.zh-CN/产品定价/计费项/快照计费.md)。

1.  登录[弹性伸缩控制台](https://essnew.console.aliyun.com/)。

2.  在左侧导航栏中，单击**伸缩组管理**。

3.  在顶部菜单栏处，选择地域。

4.  找到待操作的伸缩组，选择一种方式打开伸缩组详情页面。

    -   在**伸缩组名称/ID**区域，单击伸缩组ID。
    -   在**操作**区域，单击**查看详情**。
5.  在页面上方，单击**配置来源**页签。

6.  单击**更新镜像任务**页签。

7.  单击**更新伸缩配置中的镜像**。

8.  完成更新镜像任务的配置。

    配置项如下表所示。

    |配置项|说明|
    |---|--|
    |**实例**|选择一台ECS实例，为该ECS实例创建自定义镜像并用于更新伸缩配置中的镜像，创建自定义镜像时仅包含系统盘。|
    |**伸缩组配置ID**|选择需要更新镜像的伸缩配置，支持选择多个伸缩配置。|
    |**执行时间**|指定执行更新镜像任务的时间：     -   **现在**：立即执行任务。
    -   **定时**：在指定的时间执行任务。您需要继续指定执行时间，精确到分钟。
    -   **周期性**：选择重复执行更新镜像任务的周期和重复结束的时间，并设置每次开始更新镜像的时间。例如，在2020年8月17日设置以下周期性任务：

        -   **重复周期**：按月
        -   每月的第21天至第25天执行
        -   **开始时间**：02:00
        -   **重复结束时间**：2020年8月26日00:00
周期性任务的效果为：从2020年8月21日至从2020年8月25日，每天02:00执行一次更新镜像任务。 |
    |**权限来源**|选择OOS服务操作相关资源的权限来源：     -   **当前账号的已有权限**：使用当前账号已经拥有的权限。
    -   **指定RAM角色，使用该角色的权限**：继续选择需要OOS服务扮演的RAM角色，使用已授予该RAM角色的权限。
**说明：** 如果执行时间指定为**定时**或者**周期性**，则仅支持通过指定RAM角色来授予权限。 |

9.  单击**确定**。

    在您设置的时间自动执行更新镜像任务，您可以在任务列表中查看源ECS实例的信息和任务执行情况。

    ![镜像更新任务](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/9881470061/p129471.png)


任务执行成功后，在**伸缩配置**页面中查看结果。伸缩配置中的镜像名称为`UpdateImage_from_<源ECS实例ID>_on_<更新镜像任务ID>`的格式，表明已成功更新镜像。

![更新镜像结果](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/9881470061/p129493.png)

