# 实现自动收缩

弹性伸缩能够通过报警任务监控伸缩组内ECS实例的使用情况，并在触发报警时自动执行伸缩规则，添加或移出ECS实例。本章节介绍如何使用报警任务实现自动收缩，将2台ECS实例移出伸缩组。

已完成快速入门中的以下操作：

-   [管理弹性伸缩服务关联角色](/intl.zh-CN/快速入门/管理弹性伸缩服务关联角色.md)
-   [创建伸缩组和伸缩配置](/intl.zh-CN/快速入门/创建伸缩组和伸缩配置.md)
-   [实现自动扩张](/intl.zh-CN/快速入门/实现自动扩张.md)

本章节中使用已创建的伸缩组MyFirstScalingGroup演示自动收缩的效果，伸缩组中已经有3台ECS实例。

## 步骤一：创建伸缩规则

1.  登录[弹性伸缩控制台](https://essnew.console.aliyun.com/)。

2.  在左侧导航栏中，单击**伸缩组管理**。

3.  找到待操作的伸缩组，选择一种方式打开伸缩组详情页面。

    -   在**伸缩组名称/ID**区域，单击伸缩组ID。
    -   在**操作**区域，单击**查看详情**。
4.  在页面上方，单击**伸缩规则**页签。

5.  在页面左上角，单击**创建伸缩规则**。

6.  设置伸缩规则的属性，然后单击**确认**。

    本示例中采用以下配置，未提及的配置保持默认即可。

    |配置项|示例|
    |---|--|
    |**规则名称**|To1|
    |**伸缩规则类型**|简单规则|
    |**执行的操作**|调整至1台|


## 步骤二：创建报警任务

1.  在左侧导航栏中，单击**自动触发任务管理** \> **报警任务**。

2.  在页面右上角，单击**创建报警任务**。

3.  设置报警任务的属性，然后单击**提交**。

    本示例中采用以下配置，未提及的配置保持默认即可。

    |配置项|示例|说明|
    |---|--|--|
    |**任务名称**|EventTriggeredScalingIn|无|
    |**描述**|平均CPU使用率不足10%时移出ECS实例。|无|
    |**监控资源**|MyFirstScalingGroup|监控伸缩组MyFirstScalingGroup的指标。|
    |**监控类型**|系统监控|无|
    |**监控项**|（ECS）CPU使用率|监控伸缩组内ECS实例的CPU使用率。|
    |**统计周期（分钟）**|1分钟|1分钟统计1次数据。|
    |**统计方法**|平均值 <= 10%|如果伸缩组内ECS实例的CPU使用率平均值小于等于10%，则记录1次。|
    |**重复几次后报警**|5次|ECS实例的CPU使用率统计结果连续5次小于等于10%，则触发报警。|
    |**报警触发规则**|To1|触发报警后，执行伸缩规则To1，将伸缩组内的ECS实例数量调整为1台。|


报警任务EventTriggeredScalingIn会监控伸缩组MyFirstScalingGroup中3台ECS实例的平均CPU使用率，每分钟统计1次。如果连续5次的统计结果均小于等于10%，则触发报警，报警任务EventTriggeredScalingIn自动执行伸缩规则To1，将伸缩组MyFirstScalingGroup内的ECS实例数量调整为1台。您可以前往伸缩活动列表查看详情。

![](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/7940317951/p68070.png)

